(()=>{"use strict";var e=".popup.popup_type_avatar",t=".popup.popup_type_profile",n=".popup.popup_type_card",r=".popup__items",i=".popup__save",o=".cousteau__image",a={inputSelector:".popup__input",submitButtonSelector:i,errorMsgSelector:".popup__error-msg_type_",inactiveButtonClass:"popup__save_disabled",inputErrorClass:"popup__input_misfilled",errorClass:"popup__error-msg_visible"},l={templateSelector:".card-template",containerSelector:".table__cell",imageSelector:".table__image",iconSelector:".table__icon",likenSelector:".table__liken",titleSelector:".table__title",trashSelector:".table__trash",trashActiveClass:"table__trash_active",likeIconClass:"table__icon_like",likenActiveClass:"table__liken_active"};function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===c(i)?i:String(i)),r)}var i}function s(e,t){p(e,t),t.add(e)}function f(e,t,n){p(e,t),t.set(e,n)}function p(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function h(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var d=new WeakMap,v=new WeakMap,y=new WeakMap,m=new WeakMap,b=new WeakSet,w=new WeakSet,_=function(){function e(t,n){var r=n.cardSettings,i=n.cardTrashHandler,o=n.cardLikeHandler,a=n.сardClickHandler,l=n.trashVisibilityHandler;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s(this,w),s(this,b),f(this,d,{writable:!0,value:void 0}),f(this,v,{writable:!0,value:void 0}),f(this,y,{writable:!0,value:void 0}),f(this,m,{writable:!0,value:void 0}),this._cardName=t.name,this._cardLink=t.link,this._cardID=t._id,this._ownerID=t.owner._id,this._cardTemplate=document.querySelector(r.templateSelector),this._cardElement=h(this,w,k).call(this,r.containerSelector),this._cardFields={image:this._cardElement.querySelector(r.imageSelector),icon:this._cardElement.querySelector(r.iconSelector),liken:this._cardElement.querySelector(r.likenSelector),title:this._cardElement.querySelector(r.titleSelector),trash:this._cardElement.querySelector(r.trashSelector)},this._trashActiveClass=r.trashActiveClass,this._cardLikeClass=r.likeIconClass,this._likenActiveClass=r.likenActiveClass,this._cardFields.image.alt=this._cardName,this._cardFields.image.src=this._cardLink,this._cardFields.title.textContent=this._cardName,this._handleTrashClick=i,this._handleLikeClick=o,this._handleCardClick=a,this._handleTrashVisibility=l,this._handleTrashVisibility(this._ownerID)&&this._cardFields.trash.classList.add(this._trashActiveClass),t.likes?this._cardLikes=t.likes:this._cardLikes=[],this._updateLikesView(this._handleLikeClick(this,!0)),h(this,b,g).call(this)}var t,n;return t=e,(n=[{key:"_updateLikesView",value:function(e){this._cardFields.liken.textContent=this._cardLikes.length,this._cardFields.icon.classList.toggle(this._cardLikeClass,e),this._cardFields.liken.classList.toggle(this._likenActiveClass,this._cardLikes.length>0)}},{key:"updateLikes",value:function(e,t){this._cardLikes=e,this._updateLikesView(t)}},{key:"removeCard",value:function(){this._cardElement.remove(),this._cardElement=null}},{key:"getCard",value:function(){return this._cardElement}},{key:"getCardInfo",value:function(){return{name:this._cardName,link:this._cardLink,id:this._cardID,owner:this._ownerID,likes:this._cardLikes,element:this._cardElement,fields:{image:this._cardFields.image,icon:this._cardFields.icon,liken:this._cardFields.liken,title:this._cardFields.title,trash:this._cardFields.trash}}}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function g(){var e=this;this._cardFields.icon.addEventListener("click",(function(){e._handleLikeClick(e)})),this._handleTrashVisibility(this._ownerID)&&this._cardFields.trash.addEventListener("click",(function(){return e._handleTrashClick(e,e._cardID)})),this._cardFields.image.addEventListener("click",(function(){e._handleCardClick({src:e.getCardInfo().link,alt:e.getCardInfo().name})}))}function k(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._cardTemplate.content.querySelector(e).cloneNode(t)}function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==S(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===S(i)?i:String(i)),r)}var i}var C=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return n.addItem(e,!0)};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._renderer=r,this._itemContainer=document.querySelector(t)}var t,n;return t=e,n=[{key:"renderItems",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._renderer;return e.forEach((function(e){return n(e,t._itemContainer)})),this}},{key:"addItem",value:function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this._itemContainer.append(e):this._itemContainer.prepend(e),this}}],n&&E(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==P(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==P(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===P(i)?i:String(i)),r)}var i}function O(e,t){L(e,t),t.add(e)}function T(e,t,n){L(e,t),t.set(e,n)}function L(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function R(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}function I(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,q(e,t,"get"))}function W(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,q(e,t,"set"),n),n}function q(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var F=new WeakMap,M=new WeakMap,D=new WeakMap,x=new WeakSet,A=new WeakSet,B=new WeakSet,z=new WeakSet,V=new WeakSet,U=new WeakSet,H=new WeakSet,N=new WeakSet,G=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),O(this,N),O(this,H),O(this,U),O(this,V),O(this,z),O(this,B),O(this,A),O(this,x),T(this,F,{writable:!0,value:void 0}),T(this,M,{writable:!0,value:void 0}),T(this,D,{writable:!0,value:void 0}),W(this,F,t),W(this,M,{inputs:t.querySelectorAll(n.inputSelector),submitButton:I(this,F).querySelector(n.submitButtonSelector)}),W(this,D,{errorMsgSelector:n.errorMsgSelector,inactiveButtonClass:n.inactiveButtonClass,inputErrorClass:n.inputErrorClass,errorClass:n.errorClass})}var t,n;return t=e,(n=[{key:"enableValidation",value:function(){R(this,x,J).call(this)}},{key:"restoreForm",value:function(){R(this,V,Y).call(this)?R(this,H,$).call(this):R(this,U,Z).call(this),R(this,N,ee).call(this)}}])&&j(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function J(){var e=this;I(this,M).inputs.forEach((function(t){t.addEventListener("input",(function(t){t.preventDefault,R(e,A,K).call(e,t.target)}))}))}function K(e){e.validity.valid?(R(this,B,Q).call(this,e,!0),R(this,V,Y).call(this)||R(this,U,Z).call(this)):(R(this,z,X).call(this,e),R(this,H,$).call(this))}function Q(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=I(this,F).querySelector(I(this,D).errorMsgSelector+e.name);e.classList.remove(I(this,D).inputErrorClass),n.classList.remove(I(this,D).errorClass),t&&(n.textContent="")}function X(e){var t=I(this,F).querySelector(I(this,D).errorMsgSelector+e.name);e.classList.add(I(this,D).inputErrorClass),t.classList.add(I(this,D).errorClass),t.textContent=e.validationMessage}function Y(){return Array.from(I(this,M).inputs).some((function(e){return!e.validity.valid}))}function Z(){I(this,M).submitButton.removeAttribute("disabled"),I(this,M).submitButton.classList.remove(I(this,D).inactiveButtonClass)}function $(){I(this,M).submitButton.setAttribute("disabled",!0),I(this,M).submitButton.classList.add(I(this,D).inactiveButtonClass)}function ee(){var e=this;I(this,M).inputs.forEach((function(t){R(e,B,Q).call(e,t)}))}const te=G;function ne(e){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ne(e)}function re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==ne(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ne(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===ne(i)?i:String(i)),r)}var i}function ie(e,t){ae(e,t),t.add(e)}function oe(e,t,n){ae(e,t),t.set(e,n)}function ae(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function le(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,se(e,t,"get"))}function ce(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}function ue(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,se(e,t,"set"),n),n}function se(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var fe=new WeakMap,pe=new WeakMap,he=new WeakMap,de=new WeakSet,ve=new WeakSet,ye=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ie(this,ve),ie(this,de),oe(this,fe,{writable:!0,value:void 0}),oe(this,pe,{writable:!0,value:void 0}),oe(this,he,{writable:!0,value:void 0}),ue(this,fe,"popup_opened"),ue(this,pe,ce(this,ve,be).bind(this)),this._popupElement=document.querySelector(t),ue(this,he,this._popupElement.querySelector(".popup__close")),ce(this,de,me).call(this)}var t,n;return t=e,(n=[{key:"open",value:function(){document.addEventListener("keydown",le(this,pe)),this._popupElement.classList.add(le(this,fe))}},{key:"close",value:function(){document.removeEventListener("keydown",le(this,pe)),this._popupElement.classList.remove(le(this,fe))}}])&&re(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function me(){var e=this;le(this,he).addEventListener("click",(function(){return e.close()})),addEventListener("click",(function(t){t.target===e._popupElement&&e.close()}))}function be(e){"Escape"===e.key&&this.close()}function we(e){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},we(e)}function _e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==we(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==we(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===we(i)?i:String(i)),r)}var i}function ge(){return ge="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ee(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},ge.apply(this,arguments)}function ke(e,t){return ke=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ke(e,t)}function Se(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ee(e){return Ee=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ee(e)}function Ce(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function Pe(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,Oe(e,t,"get"))}function je(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Oe(e,t,"set"),n),n}function Oe(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var Te=new WeakMap,Le=new WeakMap,Re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ke(e,t)}(a,e);var t,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ee(r);if(i){var n=Ee(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===we(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Se(e)}(this,e)});function a(e,t){var n,r=t.image,i=t.caption;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),Ce(Se(n=o.call(this,e)),Te,{writable:!0,value:void 0}),Ce(Se(n),Le,{writable:!0,value:void 0}),je(Se(n),Te,n._popupElement.querySelector(r)),je(Se(n),Le,n._popupElement.querySelector(i)),n}return t=a,(n=[{key:"open",value:function(e){Pe(this,Te).src=e.src,Pe(this,Te).alt=e.alt,Pe(this,Le).textContent=e.alt,ge(Ee(a.prototype),"open",this).call(this)}}])&&_e(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(ye);function Ie(e){return Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ie(e)}function We(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==Ie(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ie(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===Ie(i)?i:String(i)),r)}var i}function qe(){return qe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=De(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},qe.apply(this,arguments)}function Fe(e,t){return Fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Fe(e,t)}function Me(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function De(e){return De=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},De(e)}function xe(e,t,n){Ae(e,t),t.set(e,n)}function Ae(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Be(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,Ve(e,t,"get"))}function ze(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Ve(e,t,"set"),n),n}function Ve(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var Ue=new WeakMap,He=new WeakMap,Ne=new WeakSet,Ge=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fe(e,t)}(a,e);var t,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=De(r);if(i){var n=De(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Ie(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Me(e)}(this,e)});function a(e,t){var n,r,i,l=t.formSelector,c=t.handleFormSubmit;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),Ae(r=Me(n=o.call(this,e)),i=Ne),i.add(r),xe(Me(n),Ue,{writable:!0,value:void 0}),xe(Me(n),He,{writable:!0,value:void 0}),ze(Me(n),Ue,n._popupElement.querySelector(l)),ze(Me(n),He,c),function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}(Me(n),Ne,Je).call(Me(n)),n}return t=a,(n=[{key:"open",value:function(e){e&&e(),qe(De(a.prototype),"open",this).call(this)}},{key:"close",value:function(){Be(this,Ue).reset(),qe(De(a.prototype),"close",this).call(this)}},{key:"_getInputValues",value:function(){var e=this,t={};return Array.from(Be(this,Ue).elements).forEach((function(n){n.hasAttribute("name")&&(t[n.name]=Be(e,Ue).elements[n.name].value)})),t}}])&&We(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(ye);function Je(){var e=this;Be(this,Ue).addEventListener("submit",(function(t){t.preventDefault(),Be(e,He).call(e,e._getInputValues())}))}function Ke(e){return Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ke(e)}function Qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==Ke(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ke(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===Ke(i)?i:String(i)),r)}var i}function Xe(){return Xe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$e(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Xe.apply(this,arguments)}function Ye(e,t){return Ye=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ye(e,t)}function Ze(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $e(e){return $e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$e(e)}function et(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function tt(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,rt(e,t,"get"))}function nt(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,rt(e,t,"set"),n),n}function rt(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var it=new WeakMap,ot=new WeakMap,at=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ye(e,t)}(a,e);var t,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=$e(r);if(i){var n=$e(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Ke(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ze(e)}(this,e)});function a(e,t){var n,r=t.formSelector,i=t.handleFormSubmit;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),et(Ze(n=o.call(this,e,{formSelector:r,handleFormSubmit:i})),it,{writable:!0,value:void 0}),et(Ze(n),ot,{writable:!0,value:void 0}),n}return t=a,(n=[{key:"open",value:function(e,t){nt(this,it,e),nt(this,ot,t),Xe($e(a.prototype),"open",this).call(this)}},{key:"close",value:function(e){e&&e(tt(this,ot),tt(this,it)),Xe($e(a.prototype),"close",this).call(this)}}])&&Qe(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Ge);function lt(e){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lt(e)}function ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==lt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==lt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===lt(i)?i:String(i)),r)}var i}function ut(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function st(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,pt(e,t,"get"))}function ft(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,pt(e,t,"set"),n),n}function pt(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var ht=new WeakMap,dt=new WeakMap,vt=new WeakMap,yt=new WeakMap,mt=new WeakMap,bt=function(){function e(t){var n=t.name,r=t.about,i=t.avatar,o=t.id,a=t.cohort;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ut(this,ht,{writable:!0,value:void 0}),ut(this,dt,{writable:!0,value:void 0}),ut(this,vt,{writable:!0,value:void 0}),ut(this,yt,{writable:!0,value:void 0}),ut(this,mt,{writable:!0,value:void 0}),ft(this,ht,document.querySelector(n)),ft(this,dt,document.querySelector(r)),ft(this,vt,document.querySelector(i)),ft(this,yt,o),ft(this,mt,a)}var t,n;return t=e,n=[{key:"getUserInfo",value:function(){return{name:st(this,ht).textContent,about:st(this,dt).textContent,avatar:st(this,vt).src,id:st(this,yt),cohort:st(this,mt)}}},{key:"setUserProfile",value:function(e){var t=e.name,n=e.about;st(this,ht).textContent=t,st(this,dt).textContent=n}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.about,r=e.avatar,i=e.id,o=e.cohort,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a&&!t||(st(this,ht).textContent=t),a&&!n||(st(this,dt).textContent=n),a&&!r||(st(this,vt).src=r),a&&!i||ft(this,yt,i),a&&!o||ft(this,mt,o)}}],n&&ct(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function wt(e){return wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wt(e)}function _t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==wt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==wt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===wt(i)?i:String(i)),r)}var i}var gt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._serverLogin=function(e){return t.login(e)},this._serverToken=t.token,this._userDir=t.userDir}var t,n;return t=e,n=[{key:"autorize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._userDir,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._retPromiseResponse,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";return fetch(this._serverLogin(e),{method:n,headers:{authorization:this._serverToken}}).then((function(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"".concat(e," autorize ").concat(n," ");return t(r,i)}))}},{key:"_retPromiseResponse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.ok?e.json():Promise.reject(n?t:"Api ".concat(t,"promise error: ").concat(e.status))}},{key:"getInitialCards",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._retPromiseResponse;return this.autorize("cards",e)}},{key:"updateProfile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._userDir,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._retPromiseResponse,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"PATCH";return fetch(this._serverLogin(t),{method:r,headers:{authorization:this._serverToken,"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"".concat(t," update profile ").concat(r," ");return n(e,i)}))}},{key:"updateAvatar",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"".concat(this._userDir,"/avatar"),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._retPromiseResponse;return this.updateProfile({avatar:e},t,n)}},{key:"addCard",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"cards",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._retPromiseResponse,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"POST";return this.updateProfile(e,t,n,r)}},{key:"deleteCard",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"cards/".concat(e),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._retPromiseResponse,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"DELETE";return this.autorize(t,n,r)}},{key:"addLike",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"cards/".concat(e,"/likes"),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._retPromiseResponse,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"PUT";return this.autorize(t,n,r)}},{key:"deleteLike",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"cards/".concat(e,"/likes"),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._retPromiseResponse,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"DELETE";return this.autorize(t,n,r)}}],n&&_t(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),kt=document.querySelector(".cousteau__avedit"),St=document.querySelector(".cousteau__box"),Et=document.querySelector(".cousteau__button"),Ct=document.querySelector(e).querySelector(r),Pt=document.querySelector(t).querySelector(r),jt=document.querySelector(n).querySelector(r),Ot=document.querySelector(o),Tt=Ct.querySelector(i),Lt=Pt.querySelector(i),Rt=jt.querySelector(i),It=new Ge(e,{formSelector:r,handleFormSubmit:function(e){var t=Qt(Tt);Vt.updateAvatar(e.avatarlink).then((function(e){Dt.setUserInfo({name:e.name,about:e.about,avatar:e.avatar,id:e._id,cohort:e.cohort}),Ot.src=Dt.getUserInfo().avatar,It.close()})).catch((function(e){alert("Avatar err: ".concat(e)),console.log(e)})).finally(Qt(Tt,t))}}),Wt=new Ge(t,{formSelector:r,handleFormSubmit:function(e){var t=Qt(Lt);Vt.updateProfile({name:e.profilename,about:e.profilabout}).then((function(e){Dt.setUserInfo({name:e.name,about:e.about,avatar:e.avatar,id:e._id,cohort:e.cohort}),Wt.close()})).catch((function(e){return console.log(e)})).finally(Qt(Lt,t))}}),qt=new Ge(n,{formSelector:r,handleFormSubmit:function(e){var t=Qt(Rt);Vt.addCard({name:e.cardname,link:e.cardlink}).then((function(e){xt.addItem({name:e.name,link:e.link,_id:e._id,owner:e.owner,likes:e.likes},{cardSettings:l,cardTrashHandler:Ht,cardLikeHandler:Gt}),qt.close()})).catch((function(e){return console.log(e)})).finally(Qt(Rt,t))}}),Ft=new at(".popup.popup_type_confirm",{formSelector:r,handleFormSubmit:function(){Ft.close(Nt)}}),Mt=new Re(".popup.popup_type_picture",{image:".popup__image",caption:".popup__caption"}),Dt=new bt({name:".cousteau__title",about:".cousteau__subtitle",avatar:o},!0),xt=new C(".table",(function(e,t){t.append(function(e,t){var n=e.name,r=e.link,i=e._id,o=void 0===i?null:i,a=e.owner,l=void 0===a?{_id:Dt.getUserInfo().id}:a,c=e.likes,u=void 0===c?[]:c,s=t.cardSettings,f=t.handleCardTrash,p=t.handleCardLike,h=t.handleCardClick,d=void 0===h?Mt.open.bind(Mt):h,v=t.handleTrashVisibility;return new _({name:n,link:r,_id:o,owner:l,likes:u},{cardSettings:s,cardTrashHandler:f,cardLikeHandler:p,сardClickHandler:d,trashVisibilityHandler:void 0===v?function(e){return e==Dt.getUserInfo().id}:v}).getCard()}(e,{cardSettings:l,handleCardTrash:Ht,handleCardLike:Gt}))})),At=new te(Ct,a),Bt=new te(Pt,a),zt=new te(jt,a);kt.addEventListener("click",(function(){return It.open(Jt)})),St.addEventListener("click",(function(){return Wt.open(Kt)})),Et.addEventListener("click",(function(){return qt.open(Ut)})),At.enableValidation(),Bt.enableValidation(),zt.enableValidation();var Vt=new gt({login:function(e){return"https://mesto.nomoreparties.co/v1/cohort-69/".concat(e)},token:"2820c2c8-dbab-4884-b269-611968f0327e",userDir:"users/me"});function Ut(){zt.restoreForm()}function Ht(e,t){Ft.open(e,t)}function Nt(e,t){Vt.deleteCard(e).then((function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:t).removeCard()})).catch((function(e){return console.log(e)}))}function Gt(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.getCardInfo().likes.some((function(e){return e._id==Dt.getUserInfo().id}));if(t)return n;n?Vt.deleteLike(e.getCardInfo().id).then((function(t){e.updateLikes(t.likes,!1)})).catch((function(e){return console.log(e)})):Vt.addLike(e.getCardInfo().id).then((function(t){e.updateLikes(t.likes,!0)})).catch((function(e){return console.log(e)}))}function Jt(){At.restoreForm()}function Kt(){Pt.elements.profilename.value=Dt.getUserInfo().name,Pt.elements.profilabout.value=Dt.getUserInfo().about,Bt.restoreForm()}function Qt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Сохранение ...",n=t;return(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&(n=e.textContent),e.textContent=t,n}Promise.all([Vt.autorize(),Vt.getInitialCards()]).then((function(e){Dt.setUserInfo({name:e[0].name,about:e[0].about,avatar:e[0].avatar,id:e[0]._id,cohort:e[0].cohort}),xt.renderItems(e[1])})).catch((function(e){return console.log(e)}))})();